<app-left-section-wrapper>
  <div>
    <app-nav-profile-item></app-nav-profile-item>
  </div>
  <ng-scrollbar class="full-folder-section" visibility="hover" appearance="compact">
    <div
      class="folder"
      *ngFor="let item of foldersLink"
      [ngStyle]="{'backgroundColor': item.color}"
      [routerLink]="['/folders/', item.id]"
    >
      <p *ngIf="item.title && item.title.length > 0">{{ item.title }}</p>
      <p *ngIf="!item.title" class="empty-placeholder">
        {{'placeholder.unnamedFolder' | translate}}
      </p>
    </div>
  </ng-scrollbar>
</app-left-section-wrapper>

<div
  *ngIf="loaded && (canView$ | async)"
  class="content-generic-project"
  [ngStyle]="{'background-image': (userBackground$ | async) ? 'url(' + (userBackground$ | async) + ')' : ''}"
>
  <div
    class="folder-sub-header"
    appTheme
    [ngClass]="{ 'sub-header-photo': (userBackground$ | async) }"
  >
    <div class="container info-container">
      <div class="dot" [ngStyle]="{ backgroundColor: folder?.color }"></div>
      <div class="navigation">
        <a [routerLink]="'/folders/' + (folder?.folderTypeId | folderType)?.route" class="link"
          >{{ (folder?.folderTypeId | folderType)?.tranlate | translate }}</a
        >
        <span class="divider">/</span>
        <input
          [ngModel]="folder?.title"
          [placeholder]="'placeholder.folderSmall' | translate"
          (ngModelChange)="nameChanged.next($event)"
        />
      </div>
    </div>
    <div class="container buttons-container">
      <button
        class="side-button"
        type="button"
        name="Color"
        #color
        (click)="openChangeColorPopup()"
      >
        <div class="inner-content">
          <div class="icon">
            <mat-icon svgIcon="color" [inline]="true"></mat-icon>
          </div>
          <p>{{ 'menu.color' | translate }}</p>
        </div>
        <div class="ripple-container" matRipple [matRippleTrigger]="color"></div>
      </button>
      <button class="side-button" type="button" name="share" #share (click)="openSharePopup()">
        <div class="inner-content">
          <div class="icon">
            <mat-icon svgIcon="share" [inline]="true"></mat-icon>
          </div>
          <p>{{ 'menu.share' | translate }}</p>
        </div>
        <div class="ripple-container" matRipple [matRippleTrigger]="share"></div>
      </button>
      <button
        class="side-button icon-only"
        type="button"
        name="more"
        #more
        [matMenuTriggerFor]="menu"
      >
        <div class="inner-content">
          <div class="icon">
            <mat-icon [inline]="true">more_horiz</mat-icon>
          </div>
        </div>
        <div class="ripple-container" matRipple [matRippleTrigger]="more"></div>
      </button>
    </div>
    <div class="folder-color" [ngStyle]="{ backgroundColor: folder?.color }"></div>
  </div>
  <ng-scrollbar class="scroll-helper content" visibility="hover" appearance="compact">
    <div class="content-inner">
      <div class="grid" [ngStyle]="{'opacity': ffnService.murriService.flagForOpacity ? '1' : '0'}">
        <div
          #item
          class="grid-item"
          [id]="item.id"
          *ngFor="let item of ffnService.entities"
          [ngClass]="[pService.orientationMobile? 'grid-plus' : '', (pService.fontSize$ | async) === fontSize.Big ? 'big-size' : '']"
        >
          <app-note
            [note]="item"
            [currentFolderId]="folder.id"
            (highlightNote)="ffnService.highlightNote($event)"
            (clickOnNote)="ffnService.toNote($event)"
            [ngStyle]="{'backgroundColor': item.color }"
            class="note"
          ></app-note>
        </div>
      </div>
    </div>
    <app-no-results-illustration
      *ngIf="loaded && !ffnService.isAnyEntityInLayout"
      [isShow]="loaded && !ffnService.isAnyEntityInLayout"
      [message]="'noResult.folderNotes' | translate"
      [illustration]="pService.icon.notesInnerFolder"
      typeClass="type-module"
    ></app-no-results-illustration>
  </ng-scrollbar>
  <app-spinner *ngIf="pService.spinnerActive"></app-spinner>
</div>
<div *ngIf="(canNoView$ | async) && loaded" class="wrapper">
  <app-no-results-illustration
    [isShow]="true"
    [message]="'noResult.noAccessViewFolder' | translate"
    [illustration]="pService.icon.noAccessViewFolder"
    typeClass="type-module"
  ></app-no-results-illustration>
</div>
<div class="drag-helper main-helper"></div>
<mat-menu #menu="matMenu">
  <ng-container *ngFor="let item of folderMenu | manageMenuButtons: pB.IsCanEdit: pB.IsOwner: true">
    <button
      (click)="item.operation()"
      mat-menu-item
      type="button"
      [name]="item.icon"
      *ngIf="(item?.isVisible | async) === (true || undefined || null)"
    >
      <mat-icon
        *ngIf="item.icon !== 'history'"
        [svgIcon]="item.icon"
        style="width: 1rem; height: 1rem; font-size: 1rem"
      ></mat-icon>
      <span> {{ ('menu.' + item.icon) | translate }} </span>
    </button>
  </ng-container>
</mat-menu>
