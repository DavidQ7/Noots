<div class="outer"
    [ngClass]="[isCollapse ? '' : 'half-helper', (theme$ | async) === theme.Light ? 'light' : 'dark', notes.length > 1 || folders.length > 1 ? 'many-notes' : 'one-note']">
    <div class="few-notes" *ngIf="notes.length > 1 || folders.length > 1">
        <div class="header">
            <span>{{ 'modal.ShareModal.selectedNotes' | translate }}</span>
            <i class="icon-plus" (click)="collapseToggle()"></i>
        </div>
        <ngx-simplebar *ngIf="currentWindowType === windowType.Note" [options]="pService.optionsScroll"
            [ngClass]="isCollapse ? '' : 'notes-sharing-helper'" class="notes-sharing">
            <div class="note" *ngFor="let item of notes" CustomTooltip="{{item.title}}" position="Top"
                [ngStyle]="{'backgroundColor' : item.color}" labelColor="{{item.color}}"
                [ngClass]="{'active-note': currentNote?.id === item.id}" (click)="changeNote(item)"
                flagDisable="{{ disableTooltipUser() }}">
                <p>{{item.title}}</p>
            </div>
        </ngx-simplebar>
        <ngx-simplebar *ngIf="currentWindowType === windowType.Folder" [options]="pService.optionsScroll"
            [ngClass]="isCollapse ? '' : 'notes-sharing-helper'" class="notes-sharing">
            <div class="note" *ngFor="let item of folders" CustomTooltip="{{item.title}}" position="Top"
                [ngStyle]="{'backgroundColor' : item.color}" labelColor="{{item.color}}"
                [ngClass]="{'active-note': currentFolder?.id === item.id}" (click)="changeFolder(item)"
                flagDisable="{{ disableTooltipUser() }}">
                <p>{{item.title}}</p>
            </div>
        </ngx-simplebar>
    </div>
    <div class="sharing">
        <div class="header">
            <span>{{ ('modal.ShareModal.' + data.title) | translate }}</span>
            <i class="icon-plus" mat-dialog-close></i>
        </div>
        <mat-tab-group class="tabs" mat-align-tabs="center"
            [ngClass]="(theme$ | async) === theme.Light ? 'light-tab' : 'dark-tab'" #tabs>
            <mat-tab isActive="true" label="{{ 'modal.ShareModal.access' | translate }}">
                <div class="content-access">
                    <div class="link-access-field">
                        <input *ngIf="currentWindowType === windowType.Note"
                            [ngStyle]="{'width': currentNote?.noteType !== noteType.Shared ? 'calc(100% - 40px)' : 'calc(100% - 203px)'}"
                            readonly type="text" value="{{ currentNote?.id | sharingLink: currentWindowType}}"
                            id="linkInputNote">
                        <input *ngIf="currentWindowType === windowType.Folder"
                            [ngStyle]="{'width': currentFolder?.folderType !== folderType.Shared ? 'calc(100% - 40px)' : 'calc(100% - 203px)'}"
                            readonly type="text" value="{{ currentFolder?.id | sharingLink: currentWindowType}}"
                            id="linkInputFolder">
                        <button
                            *ngIf="currentFolder?.folderType === folderType.Shared && currentWindowType === windowType.Folder"
                            class="dropdown-button" type="button" (click)="changeActive()">
                            <div class="content-button" #dropdownSelect>
                                <p *ngIf="currentFolder?.refType === refType.Viewer">Viewer</p>
                                <p *ngIf="currentFolder?.refType === refType.Editor">Editor</p>
                                <div class="icon" [ngStyle]="{'transform': dropdownActive ? 'rotate(180deg)' : '' }">
                                    <i class="icon-select-label"></i>
                                </div>
                            </div>
                            <div class="ripple-container" matRipple [matRippleTrigger]="dropdownSelect"></div>
                            <div class="dropdown" *ngIf="dropdownActive" [@showHistory]>
                                <div class="item" (click)="changeRefTypeFolder(refType.Viewer)">
                                    <p>Viewer</p>
                                </div>
                                <div class="item" (click)="changeRefTypeFolder(refType.Editor)">
                                    <p>Editor</p>
                                </div>
                            </div>
                            <div #overlay class="overlay" (click)="cancelDropdown()"></div>
                        </button>
                        <button
                            *ngIf="currentNote?.noteType === noteType.Shared && currentWindowType === windowType.Note"
                            class="dropdown-button" type="button" (click)="changeActive()">
                            <div class="content-button" #dropdownSelect>
                                <p *ngIf="currentNote?.refType === refType.Viewer">Viewer</p>
                                <p *ngIf="currentNote?.refType === refType.Editor">Editor</p>
                                <div class="icon" [ngStyle]="{'transform': dropdownActive ? 'rotate(180deg)' : '' }">
                                    <i class="icon-select-label"></i>
                                </div>
                            </div>
                            <div class="ripple-container" matRipple [matRippleTrigger]="dropdownSelect"></div>
                            <div class="dropdown" *ngIf="dropdownActive" [@showHistory]>
                                <div class="item" (click)="changeRefTypeNote(refType.Viewer)">
                                    <p>Viewer</p>
                                </div>
                                <div class="item" (click)="changeRefTypeNote(refType.Editor)">
                                    <p>Editor</p>
                                </div>
                            </div>
                            <div #overlay class="overlay" (click)="cancelDropdown()"></div>
                        </button>
                        <div class="copy" #copy (click)="copyInputLink()">
                            <div class="ripple-container" matRipple [matRippleTrigger]="copy"></div>
                            <i class="icon-copy"></i>
                        </div>
                    </div>
                    <div *ngIf="currentWindowType === windowType.Note" class="toggle-field">
                        <div class="toggle">
                            <input type="checkbox" (change)="changeNoteType()">
                            <div class="rectangle"
                                [ngClass]="currentNote?.noteType !== noteType.Shared ? '' : 'active-toggle'">
                            </div>
                            <div class="text-toggle">
                                <div class="text">
                                    <p>{{ 'modal.ShareModal.private' | translate }}</p>
                                </div>
                                <div class="text">
                                    <p>{{ 'modal.ShareModal.shared' | translate }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="toggle-description">
                            <p *ngIf="currentNote?.noteType !== noteType.Shared">Anyone on the internet with this links
                            </p>
                            <p *ngIf="currentNote?.noteType === noteType.Shared">Only people added can open with this
                                link</p>
                        </div>
                    </div>
                    <div *ngIf="currentWindowType === windowType.Folder" class="toggle-field">
                        <div class="toggle">
                            <input type="checkbox" (change)="changeFolderType()">
                            <div class="rectangle"
                                [ngClass]="currentFolder?.folderType !== folderType.Shared ? '' : 'active-toggle'">
                            </div>
                            <div class="text-toggle">
                                <div class="text">
                                    <p>{{ 'modal.ShareModal.private' | translate }}</p>
                                </div>
                                <div class="text">
                                    <p>{{ 'modal.ShareModal.shared' | translate }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="toggle-description">
                            <p *ngIf="currentFolder?.folderType !== folderType.Shared">Anyone on the internet with this
                                links
                            </p>
                            <p *ngIf="currentFolder?.folderType === folderType.Shared">Only people added can open with
                                this
                                link</p>
                        </div>
                    </div>
                </div>
                <ngx-simplebar *ngIf="currentWindowType === windowType.Note" [options]="pService.optionsScroll"
                    class="user-access">
                    <div *ngFor="let user of usersOnPrivateNote$ | async" class="user">
                        <div class="photo">
                            <img alt="user image" [src]="user.photoId">
                        </div>
                        <div class="user-info">
                            <div class="name">
                                <p>{{user.name}}</p>
                            </div>
                            <div class="email">
                                <p>{{user.email}}</p>
                            </div>
                        </div>
                        <div class="user-access-func">
                            <button type="button" name="" (click)="changeUserPermission(refType.Viewer, user.id)">
                                <div class="icon" [ngClass]="(user.accessType === refType.Viewer) ? 'black' : ''">
                                    <i class="icon-cancel"></i>
                                </div>
                            </button>
                            <div class="separator-buttons"></div>
                            <button type="button" name="" (click)="changeUserPermission(refType.Editor, user.id)">
                                <div class="icon" [ngClass]="(user.accessType === refType.Editor) ? 'black' : ''">
                                    <i class="icon-cancel"></i>
                                </div>
                            </button>
                            <div class="separator-buttons"></div>
                            <button type="button" name="" (click)="removeUserWithPermissions(user.id)">
                                <div class="icon black">
                                    <i class="icon-cancel"></i>
                                </div>
                            </button>
                        </div>
                    </div>
                </ngx-simplebar>
                <ngx-simplebar *ngIf="currentWindowType === windowType.Folder" [options]="pService.optionsScroll"
                    class="user-access">
                    <div *ngFor="let user of usersOnPrivateFolder$ | async" class="user">
                        <div class="photo">
                            <img alt="user image" [src]="user.photoId">
                        </div>
                        <div class="user-info">
                            <div class="name">
                                <p>{{user.name}}</p>
                            </div>
                            <div class="email">
                                <p>{{user.email}}</p>
                            </div>
                        </div>
                        <div class="user-access-func">
                            <button type="button" name="" (click)="changeUserPermission(refType.Viewer, user.id)">
                                <div class="icon" [ngClass]="(user.accessType === refType.Viewer) ? 'black' : ''">
                                    <i class="icon-cancel"></i>
                                </div>
                            </button>
                            <div class="separator-buttons"></div>
                            <button type="button" name="" (click)="changeUserPermission(refType.Editor, user.id)">
                                <div class="icon" [ngClass]="(user.accessType === refType.Editor) ? 'black' : ''">
                                    <i class="icon-cancel"></i>
                                </div>
                            </button>
                            <div class="separator-buttons"></div>
                            <button type="button" name="" (click)="removeUserWithPermissions(user.id)">
                                <div class="icon black">
                                    <i class="icon-cancel"></i>
                                </div>
                            </button>
                        </div>
                    </div>
                </ngx-simplebar>
            </mat-tab>
            <mat-tab label="{{ 'modal.ShareModal.Share' | translate }}">
                <div class="search">
                    <input type="search" aria-label="Search" placeholder="{{ 'modal.ShareModal.search' | translate }}"
                        [ngModel]="searchStr" (ngModelChange)="changed($event)">
                    <button type="button">
                        <div class="icon">
                            <i class="icon-search"></i>
                        </div>
                    </button>
                </div>
                <ngx-simplebar [options]="pService.optionsScroll" class="interaction-container">
                    <div *ngIf="selectedUsers.length > 0" class="mail-notification">
                        <div class="mail-container">
                            <div *ngFor="let user of selectedUsers" class="user-mail">
                                <p>{{user.email}}</p>
                                <div class="icon" (click)="removeUserFromInvites(user)">
                                    <i class="icon-plus"></i>
                                </div>
                            </div>
                        </div>
                        <div class="checkbox-notification">
                            <label>
                                {{ 'modal.ShareModal.alert' | translate }}
                                <input type="checkbox" [checked]="isSendNotification"
                                    (change)="isSendNotification = !isSendNotification">
                                <span class="checkbox">
                                    <div class="icon">
                                        <i class="icon-plus"></i>
                                    </div>
                                </span>
                            </label>
                        </div>
                        <div class="interaction-mail">
                            <textarea [(ngModel)]="messageTextArea"></textarea>
                            <div class="interaction-buttons">
                                <button class="dropdown-button" type="button" (click)="changeActive()">
                                    <div class="content-button" #AccessSelect>
                                        <p *ngIf="refTypeForInvite === refType.Viewer">
                                            {{ 'modal.ShareModal.viewer' | translate }}</p>
                                        <p *ngIf="refTypeForInvite === refType.Editor">
                                            {{ 'modal.ShareModal.editor' | translate }}</p>
                                        <div class="icon"
                                            [ngStyle]="{'transform': dropdownActive ? 'rotate(180deg)' : '' }">
                                            <i class="icon-select-label"></i>
                                        </div>
                                    </div>
                                    <div class="ripple-container" matRipple [matRippleTrigger]="AccessSelect"></div>
                                    <div class="dropdown" *ngIf="dropdownActive" [@showHistory]>
                                        <div class="item" (click)="refTypeNotification(refType.Viewer)">
                                            <p>{{ 'modal.ShareModal.viewer' | translate }}</p>
                                        </div>
                                        <div class="item" (click)="refTypeNotification(refType.Editor)">
                                            <p>{{ 'modal.ShareModal.editor' | translate }}</p>
                                        </div>
                                    </div>
                                    <div #overlay2 class="overlay" (click)="cancelDropdown()"></div>
                                </button>
                                <button class="send-button" type="button" #changeAccessRipple (click)="sendInvites()">
                                    <div class="content-button">
                                        <p>{{ 'modal.ShareModal.send' | translate }}</p>
                                    </div>
                                    <div class="ripple-container" matRipple [matRippleTrigger]="changeAccessRipple">
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="user-suggestions">
                        <div *ngFor="let user of searchUsers" class="user">
                            <div class="photo">
                                <img alt="user image" [src]="user.photoId">
                            </div>
                            <div class="email">
                                <p>{{user.email}}
                                </p>
                            </div>
                            <div class="user-access-func">
                                <button type="button" name="Share user note" (click)="addUserToInvite(user)">
                                    <div class="icon">
                                        <i class="icon-plus"></i>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </ngx-simplebar>
            </mat-tab>
        </mat-tab-group>
    </div>
</div>